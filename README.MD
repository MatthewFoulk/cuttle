Rewriting this so Kelly can try to merge it with the master